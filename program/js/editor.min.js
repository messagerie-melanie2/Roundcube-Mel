/**
 * Roundcube editor js library
 *
 * This file is part of the Roundcube Webmail client
 *
 * @licstart  The following is the entire license notice for the
 * JavaScript code in this file.
 *
 * Copyright (c) The Roundcube Dev Team
 *
 * The JavaScript code in this page is free software: you can
 * redistribute it and/or modify it under the terms of the GNU
 * General Public License (GNU GPL) as published by the Free Software
 * Foundation, either version 3 of the License, or (at your option)
 * any later version.  The code is distributed WITHOUT ANY WARRANTY;
 * without even the implied warranty of MERCHANTABILITY or FITNESS
 * FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.
 *
 * As additional permission under GNU GPL version 3 section 7, you
 * may distribute non-source (e.g., minimized or compacted) forms of
 * that code without the copy of the GNU GPL normally required by
 * section 4, provided you include this license notice and a URL
 * through which recipients can access the Corresponding Source.
 *
 * @licend  The above is the entire license notice
 * for the JavaScript code in this file.
 *
 * @author Eric Stadtherr <estadtherr@gmail.com>
 * @author Aleksander Machniak <alec@alec.pl>
 */
function _0x1463(_0x376a45,_0x2a0350){var _0xec331a=_0xec33();return _0x1463=function(_0x1463ce,_0x924d96){_0x1463ce=_0x1463ce-0x9f;var _0x327a38=_0xec331a[_0x1463ce];return _0x327a38;},_0x1463(_0x376a45,_0x2a0350);}function _0xec33(){var _0x13d0a4=['getWin','childNodes',']:not(iframe)','plugins','spellCheck','SpellcheckStart\x20SpellcheckEnd','children','<div\x20id=\x22_rc_sig\x22>','\x20|\x20fontselect\x20fontsizeselect\x20|\x20forecolor\x20backcolor','program/resources/tinymce/video.png','force_focus','appendChild','closest','file_upload_id','mimetype','BODY','\x20|\x20link\x20unlink\x20table\x20|\x20$extra\x20charmap\x20image\x20media\x20|\x20code\x20searchreplace\x20undo\x20redo','<div\x20class=\x22hint\x22>','focus','div.tox-toolbar__group','gui_objects','*[tabindex=','&_action=upload-display','insertBefore','6FbeMqC','$extra','spellcheck_active','attachments','add','set_caret_pos','end','setup_callback','spellchecker','s=5080200','spellchecker_language','vendver','\x20|\x20bullist\x20numlist\x20outdent\x20indent\x20ltr\x20rtl\x20blockquote','push','lang','focused','spelling_state_observer','prev','toggle','settings','get_label','extra_buttons','select','_file[]','change','spellcheck_resume','1338362BZznHc','old_file_drop','request_token','restart','html2plain','replace','image','828561nKYIHT','editor','file_dropped','filedrop','identities_initialized','editor-init','keydown','addEventListener','mceRemoveEditor','triggerEvent','compose_mode','comm_path','sliding','getContent','5090285OZAoSw','no_error_found','signatures','20yOcMRo','mceAddEditor','file_dialog_event+','top_posting','FormData','DOM','<br/>','set_content','autolink\x20charmap\x20code\x20hr\x20image\x20link\x20paste\x20tabfocus','setHTML','get_caret_pos','value','multipart/form-data','html','hover','<img>','start','close','identity','extra_plugins','test','content_css','open','editor-load','drop','toggleClass','_token','mceSpellCheck','registered_request_token','object','ready','get','toolbar','spell_lang','parents','color\x20font-size\x20font-family','name','#image-selector','selection','state','url','htmlpanel','shiftKey','substring','data','preventDefault','post','hidden','2407657NKSACt','each','dark','<li>','opacity:0;height:1px;width:1px','join','XHR','upload_file','nosig',':next','.hint','file_picker_entry','which','upload','format','set_language','length','resize','prepend','compose_focus_elem','text','stopPropagation','+body[style],+blockquote[style],+div[style]','setContent','tabIndex','rcmail_editor_settings','_conf','get_modifier','894195zaWvcJ','get_language','autolink\x20charmap\x20code\x20directionality\x20link\x20lists\x20image\x20media\x20nonbreaking','.upload-form','refresh','innerHTML','extend','complete','dom','btn\x20btn-secondary\x20attach','keypress','spellcheckstart','scroll','next','input[type=\x22file\x22]','indexOf','spellcheck_stop','droptarget','5642472BWOzWR','sig_below','.btn','slice','val','setup','attr','disabled_buttons','removeClass','click','&_id=','<p>','clone','cancel','_from','contenteditable','prop','\x20paste\x20table\x20tabfocus\x20searchreplace\x20spellchecker','file_dialog_event_','init','target','set_busy','nodeName','compose','href','8pt\x209pt\x2010pt\x2011pt\x2012pt\x2014pt\x2018pt\x2024pt\x2036pt','select-one','setRequestHeader','lastIndexOf','/?_task=utils&_action=spell_html&_remote=1','init_callback','env','rcmail.upload_input(\x27imageuploadform\x27)','18iUReak','spellcheck_observer','execCommand','mode','panel','setCursorLocation','_initial_conf','fake-editor-id','&_from=','firstChild','compose_id','#image-selector-list','type','getContainer','&_action=display-attachment','tabindex','spellcheck_start','update','content_style','attachment','getBody','tabfocus_elements','prepare','trigger','file_picker_type','_rc_sig','2668468APVBrC','disabled_plugins','quote_html','tox-button','uploadform','offset','task','find','image\x20media','append','first','X-Roundcube-Request','&_file=','addClass','top','update_to_dark','getElement','height','save','<div\x20class=\x22upload-form\x22>','file_picker_callback','action','spell_span','_blank','last','file_picker_close','<input>','spellcheck_state','focus\x20blur','util'];_0xec33=function(){return _0x13d0a4;};return _0xec33();}(function(_0x38abec,_0x55f0eb){var _0xca504f=_0x1463,_0xde08e5=_0x38abec();while(!![]){try{var _0x19652a=parseInt(_0xca504f(0x103))/0x1+parseInt(_0xca504f(0xe9))/0x2*(-parseInt(_0xca504f(0x10a))/0x3)+parseInt(_0xca504f(0xb3))/0x4+-parseInt(_0xca504f(0x118))/0x5+parseInt(_0xca504f(0x19a))/0x6*(parseInt(_0xca504f(0x14b))/0x7)+-parseInt(_0xca504f(0x179))/0x8+-parseInt(_0xca504f(0x167))/0x9*(-parseInt(_0xca504f(0x11b))/0xa);if(_0x19652a===_0x55f0eb)break;else _0xde08e5['push'](_0xde08e5['shift']());}catch(_0x8f2690){_0xde08e5['push'](_0xde08e5['shift']());}}}(_0xec33,0xa7053));function rcube_text_editor(_0x268d9a,_0x2df2ce){var _0x3a66a3=_0x1463,_0x3d25a7=this,_0x59ebb4=location[_0x3a66a3(0x191)][_0x3a66a3(0x108)](/[?#].*$/,'')[_0x3a66a3(0x108)](/\/$/,''),_0x20d651={'selector':'#'+($('#'+_0x2df2ce)['is']('.mce_editor')?_0x2df2ce:_0x3a66a3(0xa0)),'cache_suffix':_0x3a66a3(0xf2),'theme':'silver','language':_0x268d9a[_0x3a66a3(0xf7)],'content_css':rcmail['assets_path'](_0x268d9a[_0x3a66a3(0x130)]),'content_style':_0x268d9a[_0x3a66a3(0xab)],'menubar':![],'statusbar':![],'toolbar_drawer':_0x3a66a3(0x116),'toolbar':'bold\x20italic\x20underline\x20|\x20alignleft\x20aligncenter\x20alignright\x20alignjustify'+_0x3a66a3(0xd9),'extended_valid_elements':'font[face|size|color|style],span[id|class|align|style]','fontsize_formats':_0x3a66a3(0x192),'valid_children':_0x3a66a3(0x161),'relative_urls':![],'remove_script_host':![],'convert_urls':![],'image_description':![],'paste_webkit_style':_0x3a66a3(0x13e),'automatic_uploads':![],'paste_data_images':!![],'browser_spellcheck':!![],'contextmenu':_0x3a66a3(0xf1),'anchor_bottom':![],'anchor_top':![],'file_picker_types':_0x3a66a3(0xbb),'file_picker_callback':function(_0x4a0bc0,_0x1e6f8f,_0x341b09){var _0x1c08df=_0x3a66a3;_0x3d25a7[_0x1c08df(0xc7)](_0x4a0bc0,_0x1e6f8f,_0x341b09);}};this[_0x3a66a3(0x19b)]=function(){};_0x268d9a['spellchecker']&&(this[_0x3a66a3(0xf1)]=_0x268d9a[_0x3a66a3(0xf1)],_0x268d9a['spellcheck_observer']&&(this['spellchecker'][_0x3a66a3(0xf9)]=this[_0x3a66a3(0x19b)]=_0x268d9a[_0x3a66a3(0x19b)]));!tinymce['registered_request_token']&&(tinymce[_0x3a66a3(0x137)]=!![],tinymce[_0x3a66a3(0xd0)][_0x3a66a3(0x151)]['on']('beforeSend',function(_0x142c60){var _0x4c6bad=_0x3a66a3;_0x142c60['xhr'][_0x4c6bad(0x194)](_0x4c6bad(0xbe),rcmail['env'][_0x4c6bad(0x105)]);if(_0x142c60[_0x4c6bad(0xfc)]&&_0x142c60[_0x4c6bad(0xfc)][_0x4c6bad(0x147)])_0x142c60[_0x4c6bad(0xfc)][_0x4c6bad(0x147)]=_0x142c60['settings'][_0x4c6bad(0x147)][_0x4c6bad(0x108)](/^(method=[a-zA-Z]+&lang=)([^&]+)/,'$1'+rcmail[_0x4c6bad(0x198)]['spell_lang']);}));_0x268d9a[_0x3a66a3(0x19d)]==_0x3a66a3(0x12d)?(_0x20d651[_0x3a66a3(0x13b)]+='\x20|\x20charmap\x20hr\x20link\x20unlink\x20image\x20code\x20$extra',$[_0x3a66a3(0x16d)](_0x20d651,{'plugins':_0x3a66a3(0x123),'file_picker_types':_0x3a66a3(0x109)})):(_0x20d651[_0x3a66a3(0x13b)]+=_0x3a66a3(0xf5)+_0x3a66a3(0xe1),$['extend'](_0x20d651,{'plugins':_0x3a66a3(0x169)+_0x3a66a3(0x18a),'spellchecker_rpc_url':_0x59ebb4+_0x3a66a3(0x196),'spellchecker_language':rcmail[_0x3a66a3(0x198)][_0x3a66a3(0x13c)],'min_height':0x190}));$[_0x3a66a3(0x14c)](_0x268d9a[_0x3a66a3(0x12e)]||[],function(){var _0x3e4760=_0x3a66a3;if(_0x20d651['plugins'][_0x3e4760(0x176)](this)<0x0)_0x20d651['plugins']=_0x20d651[_0x3e4760(0xd4)]+'\x20'+this;}),$[_0x3a66a3(0x14c)](_0x268d9a[_0x3a66a3(0xfe)]||[],function(){var _0x3b9856=_0x3a66a3;if(_0x20d651[_0x3b9856(0x13b)][_0x3b9856(0x176)](this)<0x0)_0x20d651[_0x3b9856(0x13b)]=_0x20d651[_0x3b9856(0x13b)]['replace']('$extra','$extra\x20'+this);}),$[_0x3a66a3(0x14c)](_0x268d9a[_0x3a66a3(0xb4)]||[],function(){_0x20d651['plugins']=_0x20d651['plugins']['replace'](this,'');}),$[_0x3a66a3(0x14c)](_0x268d9a[_0x3a66a3(0x180)]||[],function(){var _0x9dfe7a=_0x3a66a3;_0x20d651[_0x9dfe7a(0x13b)]=_0x20d651[_0x9dfe7a(0x13b)][_0x9dfe7a(0x108)](this,'');}),_0x20d651['toolbar']=_0x20d651['toolbar'][_0x3a66a3(0x108)](_0x3a66a3(0xea),'')[_0x3a66a3(0x108)](/\|\s+\|/g,'|');if(window[_0x3a66a3(0x164)])$['extend'](_0x20d651,window[_0x3a66a3(0x164)]);_0x20d651[_0x3a66a3(0x17e)]=function(_0x4f5750){var _0x4225aa=_0x3a66a3;_0x4f5750['on'](_0x4225aa(0x18c),function(){_0x3d25a7['init_callback'](_0x4f5750);}),_0x4f5750['on'](_0x4225aa(0xd6),function(_0x596d44){var _0x2cfb78=_0x4225aa;_0x3d25a7[_0x2cfb78(0xeb)]=_0x596d44[_0x2cfb78(0xa5)]==_0x2cfb78(0x172),_0x3d25a7[_0x2cfb78(0x19b)]();}),_0x4f5750['on'](_0x4225aa(0x171),function(){rcmail['compose_type_activity']++;}),_0x4f5750['on']('click',function(_0x42764a){var _0x3da719=_0x4225aa,_0x4c6e29=$(_0x42764a[_0x3da719(0x18d)])[_0x3da719(0xdd)]('a');if(_0x4c6e29['length']&&_0x42764a[_0x3da719(0x145)])return window[_0x3da719(0x131)](_0x4c6e29[_0x3da719(0x13a)](0x0)[_0x3da719(0x191)],_0x3da719(0xca)),![];}),_0x4f5750['on'](_0x4225aa(0xcf),function(_0x4b0280){var _0x2fb454=_0x4225aa;$(_0x4f5750[_0x2fb454(0xa6)]())[_0x2fb454(0x134)](_0x2fb454(0xf8));});if(_0x20d651[_0x4225aa(0xf0)])_0x20d651[_0x4225aa(0xf0)](_0x4f5750);},rcmail[_0x3a66a3(0x113)](_0x3a66a3(0x10f),{'config':_0x20d651,'ref':_0x3d25a7,'id':_0x2df2ce}),this['id']=_0x2df2ce,this[_0x3a66a3(0x10b)]=null,this[_0x3a66a3(0x165)]=_0x20d651,this[_0x3a66a3(0x9f)]={..._0x20d651},tinymce[_0x3a66a3(0x18c)](_0x20d651),this['init_callback']=function(_0x17b7be){var _0x568d4a=_0x3a66a3;this[_0x568d4a(0x10b)]=_0x17b7be;if(rcmail[_0x568d4a(0x198)][_0x568d4a(0xc8)]==_0x568d4a(0x190)){var _0x5517fd=$('#'+this['id']),_0x4249e5=$(_0x568d4a(0xe4),_0x5517fd['parent']())['first']()['height']();if(_0x4249e5>0xc8||_0x4249e5>_0x5517fd[_0x568d4a(0xc4)]())return setTimeout(function(){var _0x45932b=_0x568d4a;_0x3d25a7[_0x45932b(0x197)](_0x17b7be);},0x12c);var _0x1b07b7=rcube_find_object(_0x568d4a(0x187)),_0x3eb71e=rcmail[_0x568d4a(0x198)]['compose_focus_elem'];if(_0x1b07b7&&_0x1b07b7['type']==_0x568d4a(0x193)){if(!rcmail[_0x568d4a(0x198)][_0x568d4a(0x10e)])rcmail['change_identity'](_0x1b07b7);_0x3eb71e&&_0x3eb71e['id']!=this['id']&&_0x3eb71e['nodeName']!='BODY'&&(window[_0x568d4a(0xe3)](),_0x3eb71e[_0x568d4a(0xe3)](),rcmail['env'][_0x568d4a(0x15e)]=null);}}rcmail['triggerEvent'](_0x568d4a(0x132),{'config':_0x20d651,'ref':_0x3d25a7}),_0x3d25a7[_0x568d4a(0xa8)](_0x3d25a7['force_focus']||_0x3eb71e&&_0x3eb71e['id']==_0x3d25a7['id']),$(window)[_0x568d4a(0x15c)]();},this[_0x3a66a3(0xaa)]=function(_0x4a5beb){var _0x3a497f=_0x3a66a3;return this['editor']['remove'](),this[_0x3a497f(0x165)]=_0x4a5beb,tinymce[_0x3a497f(0x18c)](this[_0x3a497f(0x165)]),this;},this[_0x3a66a3(0xc2)]=function(){var _0x4a115d=_0x3a66a3;let _0x15f1eb=this[_0x4a115d(0x165)];return _0x15f1eb[_0x4a115d(0x130)]=_0x4a115d(0x14d),this['update'](_0x15f1eb);},this[_0x3a66a3(0x106)]=function(){var _0x4aefe1=_0x3a66a3;return this['update']({...this[_0x4aefe1(0x9f)]});},this[_0x3a66a3(0xa8)]=function(_0x2e51ec){var _0x1a53e2=_0x3a66a3;if(rcmail['env'][_0x1a53e2(0xb9)]=='mail'&&this[_0x1a53e2(0x10b)]){var _0x14ee5b=this[_0x1a53e2(0x10b)][_0x1a53e2(0xc3)](),_0x3d4780=this[_0x1a53e2(0x10b)]['getContentAreaContainer']()[_0x1a53e2(0xd2)][0x0];if(_0x14ee5b&&_0x3d4780)_0x3d4780[_0x1a53e2(0x163)]=_0x14ee5b[_0x1a53e2(0x163)];if(_0x14ee5b[_0x1a53e2(0x163)]>0x0){var _0xfef35b=null,_0x24fe46=[':prev',_0x1a53e2(0x154)],_0xcfb49=tinymce[_0x1a53e2(0x120)]['select'](_0x1a53e2(0xe6)+_0x14ee5b[_0x1a53e2(0x163)]+_0x1a53e2(0xd3));tinymce[_0x1a53e2(0x14c)](_0xcfb49,function(_0x150ece,_0x1bf19f){if(_0x150ece['id']==_0x3d25a7['id'])return _0xfef35b=_0x1bf19f,![];}),_0xfef35b!==null&&(_0xcfb49[_0xfef35b-0x1]&&_0xcfb49[_0xfef35b-0x1]['id']&&(_0x24fe46[0x0]=_0xcfb49[_0xfef35b-0x1]['id']),_0xcfb49[_0xfef35b+0x1]&&_0xcfb49[_0xfef35b+0x1]['id']&&(_0x24fe46[0x1]=_0xcfb49[_0xfef35b+0x1]['id']),this['editor'][_0x1a53e2(0xfc)][_0x1a53e2(0xae)]=_0x24fe46[_0x1a53e2(0x150)](','));}if(bw['mz']&&bw[_0x1a53e2(0xf4)]<0x19)$(this['editor'][_0x1a53e2(0xad)]())[_0x1a53e2(0x189)](_0x1a53e2(0x188),![])[_0x1a53e2(0x189)](_0x1a53e2(0x188),!![]);}if(_0x2e51ec)this[_0x1a53e2(0xe3)]();},this[_0x3a66a3(0xe3)]=function(){var _0x18e9fc=_0x3a66a3;$(this[_0x18e9fc(0x10b)]||'#'+this['id'])[_0x18e9fc(0xe3)](),this[_0x18e9fc(0xdb)]=![];},this[_0x3a66a3(0xfb)]=function(_0x6f6c7d,_0x3251b8){var _0x5dd1f5=_0x3a66a3,_0x476679,_0x104db2,_0x5215b1,_0x56aef6='\x02\x03',_0x4b2d92=$('#'+this['id']),_0x4fd440=rcmail[_0x5dd1f5(0x198)][_0x5dd1f5(0x12d)]?rcmail[_0x5dd1f5(0x198)]['signatures'][rcmail[_0x5dd1f5(0x198)][_0x5dd1f5(0x12d)]]:null,_0xb9e8d4=_0x4fd440&&_0x4fd440['text']&&_0x4fd440['text']['length']>0x1;this[_0x5dd1f5(0x177)]();if(_0x6f6c7d){_0x104db2=_0x4b2d92[_0x5dd1f5(0x17d)]();_0xb9e8d4&&(_0x104db2=_0x104db2[_0x5dd1f5(0x108)](/\r\n/,'\x0a'),_0x104db2=_0x104db2[_0x5dd1f5(0x108)](_0x4fd440[_0x5dd1f5(0x15f)][_0x5dd1f5(0x108)](/\r\n/,'\x0a'),_0x56aef6));var _0x1d8290=function(_0x476a5b){var _0x1b3f75=_0x5dd1f5;if(_0xb9e8d4)_0x476a5b=_0x476a5b[_0x1b3f75(0x108)](_0x56aef6,_0x1b3f75(0xd8)+_0x4fd440[_0x1b3f75(0x128)]+'</div>');_0x3d25a7['force_focus']=!![],_0x4b2d92['val'](_0x476a5b),tinymce[_0x1b3f75(0x19c)](_0x1b3f75(0x11c),![],_0x3d25a7['id']);};!_0x3251b8?_0x5215b1=rcmail['plain2html'](_0x104db2,_0x1d8290):(_0x1d8290(_0x104db2),_0x5215b1=!![]);}else{if(this[_0x5dd1f5(0x10b)]){if(_0xb9e8d4){if(_0x476679=this[_0x5dd1f5(0x10b)][_0x5dd1f5(0x16f)][_0x5dd1f5(0x13a)](_0x5dd1f5(0xb2)))_0x476679=_0x476679[_0x5dd1f5(0x16c)];this[_0x5dd1f5(0x10b)]['dom'][_0x5dd1f5(0x124)]('_rc_sig',_0x56aef6);}_0x104db2=this[_0x5dd1f5(0x10b)]['getContent']();var _0x131de9=function(_0x5ef674){var _0x318318=_0x5dd1f5;tinymce[_0x318318(0x19c)](_0x318318(0x112),![],_0x3d25a7['id']),_0x3d25a7['editor']=null;if(_0xb9e8d4)_0x5ef674=_0x5ef674[_0x318318(0x108)](_0x56aef6,'\x0a'+_0x4fd440[_0x318318(0x15f)]);_0x4b2d92['val'](_0x5ef674)['focus']()[_0x318318(0xb0)]('input'),rcmail['set_caret_pos'](_0x4b2d92[_0x318318(0x13a)](0x0),0x0);};!_0x3251b8?_0x5215b1=rcmail[_0x5dd1f5(0x107)](_0x104db2,_0x131de9):(_0x131de9(_0x4b2d92[_0x5dd1f5(0x17d)]()),_0x5215b1=!![]);if(!_0x5215b1&&_0x476679)this[_0x5dd1f5(0x10b)]['dom']['setHTML'](_0x5dd1f5(0xb2),_0x476679);}}return _0x5215b1;},this[_0x3a66a3(0xa9)]=function(){var _0x233ee3=_0x3a66a3;if(this['editor'])tinymce['execCommand'](_0x233ee3(0x136),!![]),this['spellcheck_observer']();else this[_0x233ee3(0xf1)]&&this['spellchecker'][_0x233ee3(0xd5)]&&this[_0x233ee3(0xf1)][_0x233ee3(0xd5)]();},this[_0x3a66a3(0x177)]=function(){var _0x4ec719=_0x3a66a3,_0x58ed4d=this[_0x4ec719(0x10b)];if(_0x58ed4d)_0x58ed4d[_0x4ec719(0xd4)]&&_0x58ed4d[_0x4ec719(0xd4)]['spellchecker']&&this[_0x4ec719(0xeb)]&&(_0x58ed4d['execCommand'](_0x4ec719(0x136),![]),this[_0x4ec719(0x19b)]());else{if(_0x58ed4d=this['spellchecker']){if(_0x58ed4d[_0x4ec719(0x142)]&&_0x58ed4d[_0x4ec719(0x142)]!=_0x4ec719(0x139)&&_0x58ed4d['state']!=_0x4ec719(0x119))$(_0x58ed4d[_0x4ec719(0xc9)])['trigger'](_0x4ec719(0x182));}}},this[_0x3a66a3(0xce)]=function(){var _0x3d3f57=_0x3a66a3,_0x2c159a;if(this[_0x3d3f57(0x10b)])return this[_0x3d3f57(0xeb)];else{if((_0x2c159a=this[_0x3d3f57(0xf1)])&&_0x2c159a[_0x3d3f57(0x142)])return _0x2c159a['state']!=_0x3d3f57(0x139)&&_0x2c159a['state']!=_0x3d3f57(0x119);}},this[_0x3a66a3(0x102)]=function(_0x121f27){var _0x198356=_0x3a66a3,_0x30dcdb=this[_0x198356(0x10b)];if(_0x30dcdb)_0x30dcdb[_0x198356(0xd4)][_0x198356(0xf1)]['markErrors'](_0x121f27);else(_0x30dcdb=this[_0x198356(0xf1)])&&(_0x30dcdb[_0x198356(0xaf)](![],!![]),_0x30dcdb['processData'](_0x121f27));},this[_0x3a66a3(0x168)]=function(){var _0x264f71=_0x3a66a3;return rcmail[_0x264f71(0x198)][_0x264f71(0x13c)];},this[_0x3a66a3(0x15a)]=function(_0x413852){var _0x1cb2d3=_0x3a66a3,_0x175e84=this[_0x1cb2d3(0x10b)];_0x175e84&&(_0x175e84['settings'][_0x1cb2d3(0xf3)]=_0x413852),(_0x175e84=this[_0x1cb2d3(0xf1)])&&_0x175e84['setCurrentLanguage'](_0x413852),rcmail['env'][_0x1cb2d3(0x13c)]=_0x413852;},this['replace']=function(_0x354c99){var _0x1b9534=_0x3a66a3,_0x3d3ee6,_0x347c6a=this[_0x1b9534(0x10b)];if(!_0x354c99)return![];if(_0x347c6a){_0x347c6a[_0x1b9534(0xd1)]()[_0x1b9534(0xe3)]();if($['type'](_0x354c99)==_0x1b9534(0x138)&&_0x1b9534(0x128)in _0x354c99)_0x354c99=_0x354c99[_0x1b9534(0x128)],_0x3d3ee6=_0x1b9534(0x128);else{if($[_0x1b9534(0xa5)](_0x354c99)==_0x1b9534(0x138))_0x354c99=_0x354c99[_0x1b9534(0x15f)]||'';_0x354c99=rcmail[_0x1b9534(0xb5)](_0x354c99)['replace'](/\r?\n/g,_0x1b9534(0x121)),_0x3d3ee6=_0x1b9534(0x15f);}_0x347c6a[_0x1b9534(0x141)]['setContent'](_0x354c99,{'format':_0x3d3ee6});}else{if(_0x347c6a=rcube_find_object(this['id'])){var _0x3b412e=rcmail['get_input_selection'](_0x347c6a),_0x5f13f0=_0x347c6a[_0x1b9534(0x126)],_0x10072f=_0x5f13f0['substring'](0x0,_0x3b412e[_0x1b9534(0x12b)]),_0x5d1a69=_0x5f13f0[_0x1b9534(0x146)](_0x3b412e[_0x1b9534(0xef)],_0x5f13f0['length']);if($[_0x1b9534(0xa5)](_0x354c99)==_0x1b9534(0x138))_0x354c99=_0x354c99[_0x1b9534(0x15f)]||'';_0x347c6a[_0x1b9534(0x126)]=_0x10072f+_0x354c99+_0x5d1a69,rcmail[_0x1b9534(0xee)](_0x347c6a,_0x3b412e[_0x1b9534(0x12b)]+_0x354c99[_0x1b9534(0x15b)]),_0x347c6a['focus']();}}},this[_0x3a66a3(0x122)]=function(_0x2e37d2){var _0x6a221=_0x3a66a3;if(this['editor'])this[_0x6a221(0x10b)][_0x6a221(0x162)](_0x2e37d2),this['editor'][_0x6a221(0xd1)]()[_0x6a221(0xe3)]();else(ed=rcube_find_object(this['id']))&&$(ed)[_0x6a221(0x17d)](_0x2e37d2)['focus']();},this['get_content']=function(_0x3acf33){var _0x1c2f44=_0x3a66a3,_0x51b714,_0x27d35c=this[_0x1c2f44(0x10b)],_0x2619b0='',_0x2160ac=![],_0x531e14={'refresh':!![],'selection':![],'nosig':![],'format':_0x1c2f44(0x128)};if(!_0x3acf33)_0x3acf33=_0x531e14;else _0x3acf33=$['extend'](_0x531e14,_0x3acf33);_0x3acf33[_0x1c2f44(0x16b)]&&this['spellcheck_stop']();if(_0x27d35c){if(_0x3acf33[_0x1c2f44(0x141)])_0x2619b0=_0x27d35c[_0x1c2f44(0x141)][_0x1c2f44(0x117)]({'format':_0x3acf33[_0x1c2f44(0x159)]});!_0x2619b0&&(_0x2619b0=_0x27d35c[_0x1c2f44(0x117)]({'format':_0x3acf33[_0x1c2f44(0x159)]}),_0x2160ac=_0x3acf33[_0x1c2f44(0x159)]=='text');}else(_0x27d35c=rcube_find_object(this['id']))&&(_0x3acf33[_0x1c2f44(0x141)]&&(_0x2619b0=rcmail['get_input_selection'](_0x27d35c)[_0x1c2f44(0x15f)]),!_0x2619b0&&(_0x2619b0=_0x27d35c['value'],_0x2160ac=!![]));return _0x2160ac&&_0x3acf33[_0x1c2f44(0x153)]&&(_0x51b714=_0x2619b0[_0x1c2f44(0x176)]('--\x20\x0a'),_0x51b714>0x0&&(_0x2619b0=_0x2619b0[_0x1c2f44(0x146)](0x0,_0x51b714))),_0x2619b0;},this['change_signature']=function(_0x9d2bb3,_0x4914e5){var _0x3b73c1=_0x3a66a3,_0x3c15f8,_0x5e4dbc,_0x40e364=-0x1,_0x296f05=$('#'+this['id']),_0x26dd2c=_0x296f05[_0x3b73c1(0x17d)](),_0x1c7629=rcmail[_0x3b73c1(0x198)][_0x3b73c1(0x12d)];if(!this['editor']){if(_0x4914e5&&_0x1c7629&&rcmail[_0x3b73c1(0x198)]['signatures']&&rcmail['env'][_0x3b73c1(0x11a)][_0x1c7629]){_0x1c7629=rcmail[_0x3b73c1(0x198)]['signatures'][_0x1c7629][_0x3b73c1(0x15f)],_0x1c7629=_0x1c7629[_0x3b73c1(0x108)](/\r\n/g,'\x0a'),_0x40e364=rcmail[_0x3b73c1(0x198)]['top_posting']?_0x26dd2c[_0x3b73c1(0x176)](_0x1c7629):_0x26dd2c[_0x3b73c1(0x195)](_0x1c7629);if(_0x40e364>=0x0)_0x26dd2c=_0x26dd2c[_0x3b73c1(0x146)](0x0,_0x40e364)+_0x26dd2c[_0x3b73c1(0x146)](_0x40e364+_0x1c7629[_0x3b73c1(0x15b)],_0x26dd2c[_0x3b73c1(0x15b)]);}if(_0x4914e5&&rcmail['env']['signatures']&&rcmail[_0x3b73c1(0x198)]['signatures'][_0x9d2bb3]){_0x1c7629=rcmail[_0x3b73c1(0x198)][_0x3b73c1(0x11a)][_0x9d2bb3][_0x3b73c1(0x15f)],_0x1c7629=_0x1c7629[_0x3b73c1(0x108)](/\r\n/g,'\x0a');if(_0x40e364>=0x0)_0x26dd2c=_0x26dd2c['substring'](0x0,_0x40e364)+_0x1c7629+_0x26dd2c[_0x3b73c1(0x146)](_0x40e364,_0x26dd2c[_0x3b73c1(0x15b)]),_0x5e4dbc=_0x40e364-0x1;else{if(!_0x26dd2c||!rcmail['env'][_0x3b73c1(0x114)])_0x5e4dbc=_0x26dd2c[_0x3b73c1(0x15b)],_0x26dd2c+='\x0a\x0a'+_0x1c7629;else rcmail[_0x3b73c1(0x198)][_0x3b73c1(0x11e)]&&!rcmail['env'][_0x3b73c1(0x17a)]?(pos=rcmail[_0x3b73c1(0x125)](_0x296f05[_0x3b73c1(0x13a)](0x0)))?(_0x26dd2c=_0x26dd2c[_0x3b73c1(0x146)](0x0,pos)+'\x0a'+_0x1c7629+'\x0a\x0a'+_0x26dd2c[_0x3b73c1(0x146)](pos,_0x26dd2c[_0x3b73c1(0x15b)]),_0x5e4dbc=pos):(_0x26dd2c='\x0a\x0a'+_0x1c7629+'\x0a\x0a'+_0x26dd2c[_0x3b73c1(0x108)](/^[\r\n]+/,''),_0x5e4dbc=0x0):(_0x26dd2c=_0x26dd2c[_0x3b73c1(0x108)](/[\r\n]+$/,''),_0x5e4dbc=!rcmail['env'][_0x3b73c1(0x11e)]&&_0x26dd2c['length']?_0x26dd2c[_0x3b73c1(0x15b)]+0x1:0x0,_0x26dd2c+='\x0a\x0a'+_0x1c7629);}}else _0x5e4dbc=rcmail['env'][_0x3b73c1(0x11e)]?0x0:_0x26dd2c[_0x3b73c1(0x15b)];_0x296f05[_0x3b73c1(0x17d)](_0x26dd2c),rcmail[_0x3b73c1(0xee)](_0x296f05[_0x3b73c1(0x13a)](0x0),_0x5e4dbc);}else{if(_0x4914e5&&rcmail['env']['signatures']){var _0x44ce0f=this[_0x3b73c1(0x10b)][_0x3b73c1(0x16f)][_0x3b73c1(0x13a)](_0x3b73c1(0xb2));if(!_0x44ce0f){var _0x210f3d=this['editor'][_0x3b73c1(0xad)]();_0x44ce0f=$('<div\x20id=\x22_rc_sig\x22></div>')[_0x3b73c1(0x13a)](0x0);if(rcmail['env'][_0x3b73c1(0x11e)]&&!rcmail[_0x3b73c1(0x198)]['sig_below']&&rcmail['env'][_0x3b73c1(0x114)]&&(_0x210f3d[_0x3b73c1(0xd2)]['length']>0x1||$(_0x210f3d)['text']())){this[_0x3b73c1(0x10b)][_0x3b73c1(0xd1)]()[_0x3b73c1(0xe3)]();var _0x1d346d=this[_0x3b73c1(0x10b)][_0x3b73c1(0x141)]['getNode']();$(_0x44ce0f)[_0x3b73c1(0xe8)](_0x1d346d[_0x3b73c1(0x18f)]==_0x3b73c1(0xe0)?_0x210f3d[_0x3b73c1(0xa2)]:_0x1d346d['nextSibling']),$(_0x3b73c1(0x184))[_0x3b73c1(0xbc)]($('<br>'))[_0x3b73c1(0xe8)](_0x44ce0f);}else _0x210f3d[_0x3b73c1(0xdc)](_0x44ce0f),_0x3c15f8=rcmail[_0x3b73c1(0x198)][_0x3b73c1(0x11e)]&&rcmail[_0x3b73c1(0x198)][_0x3b73c1(0x114)]?_0x210f3d[_0x3b73c1(0xa2)]:$(_0x44ce0f)[_0x3b73c1(0xfa)]();}_0x44ce0f[_0x3b73c1(0x16c)]=rcmail[_0x3b73c1(0x198)]['signatures'][_0x9d2bb3]?rcmail[_0x3b73c1(0x198)]['signatures'][_0x9d2bb3][_0x3b73c1(0x128)]:'';}else!rcmail['env']['top_posting']&&(_0x3c15f8=$(this[_0x3b73c1(0x10b)][_0x3b73c1(0xad)]())[_0x3b73c1(0xd7)]()['last']());}this[_0x3b73c1(0x10b)]&&_0x3c15f8&&_0x3c15f8[_0x3b73c1(0x15b)]&&(this[_0x3b73c1(0x10b)][_0x3b73c1(0x141)][_0x3b73c1(0x19f)](_0x3c15f8['get'](0x0)),this['editor']['getWin']()[_0x3b73c1(0x173)](0x0,_0x3c15f8[_0x3b73c1(0xb8)]()[_0x3b73c1(0xc1)]));},this[_0x3a66a3(0xc5)]=function(){var _0xc1deb0=_0x3a66a3;this[_0xc1deb0(0x10b)]&&this[_0xc1deb0(0x10b)][_0xc1deb0(0xc5)]();},this[_0x3a66a3(0xe3)]=function(){var _0xf97020=_0x3a66a3;(this[_0xf97020(0x10b)]||rcube_find_object(this['id']))['focus']();},this[_0x3a66a3(0xc7)]=function(_0x2823f6,_0x2c9ef1,_0x1b0cec){var _0x3074de=_0x3a66a3,_0x503724,_0x4ea37c,_0x4e2103,_0x17fcb6,_0x183817,_0x45f501,_0x2ccd06,_0x15c0b0=[],_0x578b4d=_0x1b0cec['filetype'],_0x91eb1c=$(_0x3074de(0x16a))[_0x3074de(0x185)]();this[_0x3074de(0x10b)]['windowManager'][_0x3074de(0x131)]({'title':rcmail[_0x3074de(0xfd)](_0x3074de(0xff)+_0x578b4d),'body':{'type':_0x3074de(0x19e),'items':[{'type':_0x3074de(0x144),'html':'<div\x20id=\x22image-selector\x22\x20class=\x22image-selector\x20file-upload\x22><ul\x20id=\x22image-selector-list\x22\x20class=\x22attachmentslist\x22></ul></div>'}]},'buttons':[{'type':_0x3074de(0x186),'text':rcmail['get_label'](_0x3074de(0x12c)),'onclick':function(){var _0x23f715=_0x3074de;_0x3d25a7[_0x23f715(0xcc)]();}}]}),rcmail[_0x3074de(0x198)][_0x3074de(0xc7)]=_0x2823f6,rcmail[_0x3074de(0x198)]['file_picker_type']=_0x578b4d,_0x183817=$(_0x3074de(0x140));if(!_0x91eb1c[_0x3074de(0x15b)])_0x91eb1c=this['file_upload_form'](rcmail[_0x3074de(0xe5)][_0x3074de(0xb7)]);else _0x91eb1c['find']('button,a.button')[_0x3074de(0x17c)](0x1)['remove']();_0x4ea37c=_0x183817[_0x3074de(0x15d)](_0x91eb1c)[_0x3074de(0xba)]('button,a.button')[_0x3074de(0x15f)](rcmail[_0x3074de(0xfd)](_0x3074de(0xed)+_0x578b4d))[_0x3074de(0xe3)]();if(!_0x4ea37c['is'](_0x3074de(0x17b)))_0x4ea37c[_0x3074de(0xc0)](_0x3074de(0xb6));for(_0x503724 in rcmail['env'][_0x3074de(0xec)]){(_0x4e2103=_0x3d25a7[_0x3074de(0x156)](_0x503724,rcmail[_0x3074de(0x198)][_0x3074de(0xec)][_0x503724]))&&_0x15c0b0[_0x3074de(0xf6)](_0x4e2103);}_0x17fcb6=_0x183817[_0x3074de(0x13d)]('.tox-dialog')[_0x3074de(0xba)]('button')[_0x3074de(0xcb)](),_0x15c0b0=$(_0x3074de(0xa4))[_0x3074de(0xbc)](_0x15c0b0)['on'](_0x3074de(0x110),'li',function(_0x251c17){var _0xa0d5c9=_0x3074de;if(_0x251c17[_0xa0d5c9(0x157)]==0x9){if(rcube_event['get_modifier'](_0x251c17)==SHIFT_KEY)!$(this)[_0xa0d5c9(0xfa)]()['focus']()[_0xa0d5c9(0x15b)]&&_0x4ea37c[_0xa0d5c9(0xe3)]();else!$(this)[_0xa0d5c9(0x174)]()['focus']()[_0xa0d5c9(0x15b)]&&_0x17fcb6[_0xa0d5c9(0xe3)]();return![];}}),_0x4ea37c[_0x3074de(0x110)](function(_0x393c46){var _0x3abbc4=_0x3074de;if(_0x393c46['which']==0x9)return(rcube_event[_0x3abbc4(0x166)](_0x393c46)==SHIFT_KEY||!_0x15c0b0[_0x3abbc4(0xba)]('li')[_0x3abbc4(0xbd)]()[_0x3abbc4(0xe3)]()['length'])&&_0x17fcb6['focus'](),![];_0x393c46[_0x3abbc4(0x157)]==0xd&&this[_0x3abbc4(0x182)]();}),_0x17fcb6['keydown'](function(_0x27aba1){var _0x500e20=_0x3074de;if(_0x27aba1[_0x500e20(0x157)]==0x9)return(rcube_event[_0x500e20(0x166)](_0x27aba1)!=SHIFT_KEY||!_0x15c0b0[_0x500e20(0xba)]('li')[_0x500e20(0xcb)]()[_0x500e20(0xe3)]()['length'])&&_0x4ea37c['focus'](),![];}),window[_0x3074de(0x11f)]&&(!rcmail[_0x3074de(0x198)][_0x3074de(0x10d)]&&(rcmail['env'][_0x3074de(0x10d)]={}),rcmail['gui_objects'][_0x3074de(0x10d)]&&(rcmail['env'][_0x3074de(0x104)]=rcmail[_0x3074de(0xe5)]['filedrop']),rcmail[_0x3074de(0xe5)][_0x3074de(0x10d)]=$(_0x3074de(0x140)),rcmail['gui_objects'][_0x3074de(0x10d)][_0x3074de(0xc0)](_0x3074de(0x178))['on']('dragover\x20dragleave',function(_0x518cfd){var _0x2bcb77=_0x3074de;_0x518cfd[_0x2bcb77(0x148)](),_0x518cfd[_0x2bcb77(0x160)](),$(this)[_0x518cfd[_0x2bcb77(0xa5)]=='dragover'?'addClass':_0x2bcb77(0x181)](_0x2bcb77(0x129));})['get'](0x0)['addEventListener'](_0x3074de(0x133),function(_0x21ccf1){var _0x45f9a6=_0x3074de;return rcmail[_0x45f9a6(0x10c)](_0x21ccf1);},![])),!rcmail[_0x3074de(0x198)][_0x3074de(0x18b)+_0x578b4d]&&(rcmail['env'][_0x3074de(0x11d)+_0x578b4d]=!![],rcmail[_0x3074de(0x111)]('fileuploaded',function(_0x3d6884){var _0x2340ac=_0x3074de,_0x59fe1b;(_0x59fe1b=_0x3d25a7[_0x2340ac(0x156)](_0x3d6884[_0x2340ac(0x13f)],_0x3d6884[_0x2340ac(0xac)]))&&(_0x15c0b0[_0x2340ac(0x15d)](_0x59fe1b),_0x59fe1b[_0x2340ac(0xe3)]());}));},this['file_picker_close']=function(_0x57efc1){var _0x4f58aa=_0x3a66a3;this[_0x4f58aa(0x10b)]['windowManager']['close']();if(_0x57efc1)rcmail[_0x4f58aa(0x198)][_0x4f58aa(0xc7)](_0x57efc1);if(rcmail[_0x4f58aa(0x198)]['old_file_drop'])rcmail[_0x4f58aa(0xe5)][_0x4f58aa(0x10d)]=rcmail['env'][_0x4f58aa(0x104)];},this['file_picker_entry']=function(_0x3e8756,_0x22f02b){var _0x3ad65f=_0x3a66a3;if(!_0x22f02b[_0x3ad65f(0x16e)]||!_0x22f02b['mimetype'])return;rcmail[_0x3ad65f(0xde)]&&rcmail[_0x3ad65f(0x18e)](![],null,rcmail[_0x3ad65f(0xde)]);var _0x151416,_0x537905;switch(rcmail['env'][_0x3ad65f(0xb1)]){case'image':_0x151416=/^image\//i;break;case'media':_0x151416=/^video\//i,_0x537905=rcmail['assets_path'](_0x3ad65f(0xda));break;default:return;}if(_0x151416[_0x3ad65f(0x12f)](_0x22f02b[_0x3ad65f(0xdf)])){var _0x206526=rcmail[_0x3ad65f(0x198)][_0x3ad65f(0x115)]+_0x3ad65f(0xa1)+rcmail[_0x3ad65f(0x198)][_0x3ad65f(0xc8)],_0x2432bc=rcmail[_0x3ad65f(0x198)][_0x3ad65f(0xa3)]?_0x3ad65f(0x183)+rcmail[_0x3ad65f(0x198)][_0x3ad65f(0xa3)]+_0x3ad65f(0xa7):_0x3ad65f(0xe7),_0x46b7c7=_0x206526+_0x2432bc+_0x3ad65f(0xbf)+_0x3e8756,_0x33309b=$(_0x3ad65f(0x12a))[_0x3ad65f(0x17f)]({'title':_0x22f02b[_0x3ad65f(0x13f)],'src':_0x537905?_0x537905:_0x46b7c7+'&_thumbnail=1'});return $(_0x3ad65f(0x14e))[_0x3ad65f(0x17f)]({'tabindex':0x0})[_0x3ad65f(0x147)](_0x3ad65f(0x143),_0x46b7c7)[_0x3ad65f(0xbc)]($('<span\x20class=\x22img\x22>')[_0x3ad65f(0xbc)](_0x33309b))[_0x3ad65f(0xbc)]($('<span\x20class=\x22name\x22>')[_0x3ad65f(0x15f)](_0x22f02b[_0x3ad65f(0x13f)]))['click'](function(){var _0x356daf=_0x3ad65f;_0x3d25a7[_0x356daf(0xcc)]($(this)[_0x356daf(0x147)](_0x356daf(0x143)));})[_0x3ad65f(0x110)](function(_0x58553e){var _0x1473aa=_0x3ad65f;_0x58553e[_0x1473aa(0x157)]==0xd&&_0x3d25a7[_0x1473aa(0xcc)]($(this)[_0x1473aa(0x147)](_0x1473aa(0x143)));});}},this['file_upload_form']=function(_0x114a33){var _0x695aad=_0x3a66a3,_0x24c937=_0x114a33?$(_0x114a33)[_0x695aad(0xba)](_0x695aad(0x155))['text']():'',_0x2c2179=$('<form\x20id=\x22imageuploadform\x22>')[_0x695aad(0x17f)]({'method':_0x695aad(0x149),'enctype':_0x695aad(0x127)});file=$('<input>')[_0x695aad(0x17f)]({'name':_0x695aad(0x100),'type':'file','multiple':!![],'style':_0x695aad(0x14f)})[_0x695aad(0x101)](function(){var _0x354c79=_0x695aad;rcmail[_0x354c79(0x152)](_0x2c2179,_0x354c79(0x158));}),wrapper=$(_0x695aad(0xc6))[_0x695aad(0xbc)]($('<button>')[_0x695aad(0x17f)]({'class':_0x695aad(0x170),'href':'#','onclick':_0x695aad(0x199)}));if(_0x24c937)wrapper[_0x695aad(0x15d)]($(_0x695aad(0xe2))['text'](_0x24c937));return _0x114a33&&(file[_0x695aad(0x17f)](_0x695aad(0x13f),$(_0x695aad(0x175),_0x114a33)[_0x695aad(0x17f)](_0x695aad(0x13f))),_0x2c2179['attr'](_0x695aad(0xc8),$(_0x114a33)[_0x695aad(0x17f)](_0x695aad(0xc8)))),_0x2c2179[_0x695aad(0xbc)](file)[_0x695aad(0xbc)]($(_0x695aad(0xcd))[_0x695aad(0x17f)]({'type':_0x695aad(0x14a),'name':_0x695aad(0x135),'value':rcmail[_0x695aad(0x198)][_0x695aad(0x105)]})),wrapper[_0x695aad(0xbc)](_0x2c2179);};}