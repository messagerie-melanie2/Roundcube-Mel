/**
 * Roundcube functions for default skin interface
 *
 * Copyright (c) The Roundcube Dev Team
 *
 * The contents are subject to the Creative Commons Attribution-ShareAlike
 * License. It is allowed to copy, distribute, transmit and to adapt the work
 * by keeping credits to the original autors in the README file.
 * See http://creativecommons.org/licenses/by-sa/3.0/ for details.
 *
 * @license magnet:?xt=urn:btih:90dc5c0be029de84e523b9b3922520e79e0e6f08&dn=cc0.txt CC0-1.0
 */
/*
 magnet:?xt=urn:btih:90dc5c0be029de84e523b9b3922520e79e0e6f08&dn=cc0.txt CC0-1.0
*/
function rcube_mail_ui(){function k(a){u||(u=rcmail.local_storage_get_item("prefs.larry",{}));if(null==u[a]){var c=rcmail.get_cookie(a);null!=c&&(u[a]=c,rcmail.local_storage_set_item("prefs.larry",u)&&rcmail.set_cookie(a,c,new Date))}return u[a]}function v(a,c){u[a]=c;if(!rcmail.local_storage_set_item("prefs.larry",u)){var b=new Date;b.setYear(b.getFullYear()+1);rcmail.set_cookie(a,c,b)}}function w(a){a=a?10:0;rcmail.resize_timeout&&window.clearTimeout(rcmail.resize_timeout);rcmail.resize_timeout=
window.setTimeout(function(){"mail"==rcmail.env.task&&("show"==rcmail.env.action||"preview"==rcmail.env.action?e():"compose"==rcmail.env.action&&x());$("body.iframe .footerleft").each(function(){var c=$(this),b=$(document.body),d=c.hasClass("floating"),f=b.outerHeight(!0)>$(window).height();f!=d&&(d=f?"addClass":"removeClass",c[d]("floating"),b[d]("floatingbuttons"))})},a)}function p(a){var c=$(a.object).siblings("div");c.length&&$(a.object).insertBefore(c.first());if("error"==a.type&&"login"!=rcmail.env.task){rcmail.hide_message(a.object);
r.message_timer&&window.clearTimeout(r.message_timer);r.messagedialog||(r.messagedialog=$("<div>").addClass("popupdialog").hide());c=a.message;var b=function(){r.messagedialog.is(":visible")&&r.messagedialog.dialog("destroy").hide()};r.messagedialog.is(":visible")&&r.messagedialog.text()!=c&&(c=r.messagedialog.html()+"<p>"+a.message+"</p>");r.messagedialog.html(c).dialog({resizable:!1,closeOnEscape:!0,dialogClass:a.type,title:rcmail.gettext("errortitle"),close:b,hide:{effect:"fadeOut"},width:420,
minHeight:90}).show();r.messagedialog.closest("div[role=dialog]").attr("role","alertdialog");0<a.timeout&&(r.message_timer=window.setTimeout(b,a.timeout))}}function y(a){var c=a?a.new_layout:rcmail.env.layout,b=$("#mailview-top"),d=$("#mailview-bottom");a&&$("#mainscreencontent").removeClass().addClass(c);$("#mailviewsplitter")["desktop"==c?"show":"hide"]();$("#mailviewsplitter2")["widescreen"==c?"show":"hide"]();$("#mailpreviewframe")["list"!=c?"show":"hide"]();rcmail.env.contentframe="list"==c?
null:"messagecontframe";"widescreen"==c?($("#countcontrols").detach().appendTo($("#messagelistheader")),b.css({height:"auto",width:394}),d.css({top:0,left:406,height:"auto"}).show(),D?D.resize():(D=new rcube_splitter({id:"mailviewsplitter2",p1:"#mailview-top",p2:"#mailview-bottom",orientation:"v",relative:!0,start:416,min:400,size:12}),D.init())):"desktop"==c?(b.css({height:270,width:"auto"}),d.css({left:0,top:284,height:"auto"}).show(),E?E.resize():(E=new rcube_splitter({id:"mailviewsplitter",p1:"#mailview-top",
p2:"#mailview-bottom",orientation:"h",relative:!0,start:276,min:150,size:12,offset:4}),E.init())):(b.css({height:"auto",width:"auto"}),d.hide());a&&"widescreen"==a.old_layout&&$("#countcontrols").detach().appendTo($("#messagelistfooter"))}function e(){$("#messagecontent").css("top",$("#messageheader").outerHeight()+1+"px");$("#message-objects div a").addClass("button");$("#attachment-list li").length||($("div.rightcol").hide().attr("aria-hidden","true"),$("div.leftcol").css("margin-right","0"));var a=
$("#messagebody.mailvelope, #messagebody > .mailvelope");if(a.length){var c=$("#messagecontent").length?$("#messagecontent").height()-16:$(window).height()-a.offset().top-2;a.height(c)}}function g(a){}function n(a){}function t(){var a,c=["cc","bcc","replyto","followupto"];for(a=0;a<c.length;a++){var b=c[a];var d=$("#_"+b);d.length&&(d.on("change",{v:b},function(f){this.value&&I(f.data.v,!0)}),""!=d.val()&&I(b,!0))}$("textarea[name='_to'], textarea[name='_cc'], textarea[name='_bcc']").change(function(f){B(this)}).change();
rcmail.addEventListener("autocomplete_insert",function(f){B(f.field)})}function B(a){if("TEXTAREA"==a.nodeName){var c=$(a),b=a.scrollHeight;c.css("height",14*(80<a.value.length&&21<b?2:1)+"px");x()}}function x(){var a=$("#composebody"),c=$("#compose-content"),b=$("#composeview-bottom");if(c.length){var d=c.height()-b.position().top;var f=300-d;b.height(Math.max(300,d));c.css("overflow",0<f?"auto":"hidden");c=a.parent().width()-5;b=a.parent().height()-8;a.width(c).height(b);$("#composebodycontainer > div").width(c+
8);$("#composebody_ifr").height(b+4-$("div.mce-toolbar").height());$("#googie_edit_layer").width(c).height(b);a=$("#directorylist");a.length&&$("#compose-contacts .scroller").css("top",a.position().top+a.outerHeight())}}function J(a){var c=$("#quotadisplay"),b=$("#quotamenu"),d=a.total?24*Math.ceil(a.percent/100*20):0;a.total&&480==d&&100>a.percent&&(d-=24);c.css("background-position","0 -"+d+"px");c.attr("class","countdisplay p"+10*Math.round(a.percent/10));a.table&&(b.length||(b=$('<div id="quotamenu" class="popupmenu">').appendTo($("body"))),
b.html(a.table),c.css("cursor","pointer").off("click").on("click",function(f){return rcmail.command("menu-open","quotamenu",f.target,f)}))}function N(a){$(".boxtitle a.search",a).click(function(c){var b=$(".boxtitle",a),d=$(".listsearchbox",a),f=d.is(":visible")?-1:1,l=34+($("select",d).length?22:0);d.slideToggle({duration:160,progress:function(m,q){0>f&&(q=1-q);$(".scroller",a).css("top",b.outerHeight()+l*q+"px")},complete:function(){d.toggleClass("expanded");d.is(":visible")?(d.find("input[type=text]").focus(),
l=34+($("select",d).length?$("select",d).outerHeight()+4:0),$(".scroller",a).css("top",b.outerHeight()+l+"px")):$("a.reset",d).click()}});return!1})}function R(a){"reply-list"==a.command&&1==rcmail.env.reply_all_mode?(a=rcmail.gettext(a.status?"replylist":"replyall"),"preview"==rcmail.env.action?$("a.button.replyall").attr("title",a):$("a.button.reply-all").text(a).attr("title",a)):"compose-encrypted"==a.command?$("a.button.encrypt").parent().show():"compose-encrypted-signed"==a.command&&$("#encryptionmenulink").show()}
function K(a,c){var b=F[a]=$("#"+a);b.appendTo(document.body);b.length&&(z[a]=$.extend(z[a]||{},c||{}))}function O(){$("#preview-shortheaders").toggle();var a=$("#preview-allheaders").toggle(),c=$("a#previewheaderstoggle");a.is(":visible")?c.attr("href","#hide").removeClass("add").addClass("remove").attr("aria-expanded","true"):c.attr("href","#details").removeClass("remove").addClass("add").attr("aria-expanded","false");v("previewheaders",a.is(":visible")?"1":"0")}function G(a,c){if(c||!$("#mail"+
a+"mode").hasClass("disabled"))$("#maillistmode, #mailthreadmode").removeClass("selected").attr("tabindex","0").attr("aria-disabled","false"),$("#mail"+a+"mode").addClass("selected").attr("tabindex","-1").attr("aria-disabled","true")}function H(a){if(a&&"messagelistmenu"==a.name)S(a);else if(a){var c=z[a.name]||{},b=$(c.link||"#"+a.name+"link"),d=a.obj&&a.obj.is(":visible");if(a.obj&&d&&b.length){var f=b.parent();$(window);f.hasClass("dropbutton")&&(b=f);if(c.above||b.hasClass("dropbutton"))f=b.offset(),
a.obj.css({left:f.left+"px",top:f.top+(c.above?-a.obj.height():b.outerHeight())+"px"})}a.obj&&c.iconized&&a.obj.children("ul").addClass("iconized");a.obj&&c.editable&&a.obj.attr("data-editable","true");"function"==typeof c.callback&&c.callback(d,a)}}function T(a,c){var b=a.parentNode.id.replace(/^attach/,"");$.each(["open","download","rename"],function(){var d=this;$("#attachmenu"+d).off("click").attr("onclick","").click(function(f){return rcmail.command(d+"-attachment",b,this)})});z.attachmentmenu.link=
a;rcmail.command("menu-open",{menu:"attachmentmenu",id:b},a,c)}function L(a){a=$(a);if(!a.children(".drop").length){var c=rcmail.gettext("options"),b=a.find("a.filename"),d=b.attr("tabindex")||0;c=$("<a>").attr({"class":"drop skip-content",tabindex:d,"aria-haspopup":!0,title:c}).text(c).on("click keypress",function(f){if("keypress"!=f.type||13==rcube_event.get_keycode(f))return T(this,f),!1});b.length?c.insertAfter(b):c.appendTo(a)}}function S(a){var c=$("#listoptions");c.is(":visible")?c.dialog("close",
a.originalEvent):($('input[name="sort_col"][value="'+rcmail.env.sort_col+'"]').prop("checked",!0),$('input[name="sort_ord"][value="DESC"]').prop("checked","DESC"==rcmail.env.sort_order),$('input[name="sort_ord"][value="ASC"]').prop("checked","DESC"!=rcmail.env.sort_order),$.each(["widescreen","desktop","list"],function(){$('input[name="layout"][value="'+this+'"]').prop("checked",rcmail.env.layout==this)}),$("#listoptions-columns",c)["widescreen"==rcmail.env.layout?"hide":"show"](),$('input[name="list_col[]"]').each(function(){$(this).prop("checked",
-1!=$.inArray(this.value,rcmail.env.listcols))}),c.dialog({modal:!0,resizable:!1,closeOnEscape:!0,title:null,open:function(b){setTimeout(function(){c.find("a, input:not(:disabled)").not("[aria-disabled=true]").first().focus()},100)},close:function(b){c.dialog("destroy").hide();b.originalEvent&&rcube_event.is_keyboard(b.originalEvent)&&$("#listmenulink").focus()},minWidth:500,width:c.width()+25}).show())}function U(a){$("#listoptions").dialog("close");rcube_event.is_keyboard(a.originalEvent)&&$("#listmenulink").focus();
a=$('input[name="sort_col"]:checked').val();var c=$('input[name="sort_ord"]:checked').val(),b=$('input[name="layout"]:checked').val(),d=$('input[name="list_col[]"]:checked').map(function(){return this.value}).get();rcmail.set_list_options(d,a,c,rcmail.env.threading,b)}function V(a){a=$("#contacts-table");var c=a.parent().css("overflow","hidden");a.clone().css({position:"absolute",top:"0",left:"0",width:a.width()+"px","z-index":10}).appendTo(c).animate({left:-(a.width()+5)+"px"},300,"swing",function(){$(this).remove();
c.css("overflow","auto")})}function W(a){a=$("#contacts-table");var c=a.parent().css("overflow","hidden"),b=a.clone().appendTo(c);a.css({position:"absolute",top:"0",left:-(a.width()+5)+"px",width:a.width()+"px",height:a.height()+"px","z-index":10}).animate({left:"0"},300,"linear",function(){b.remove();$(this).css({position:"relative",left:"0",width:"100%",height:"auto","z-index":1});c.css("overflow","auto")})}function I(a,c){var b=$("#compose-"+a);if(!b.is(":visible"))return M[a]&&!c&&$("#_"+a).val(M[a]),
b.show(),$("#"+a+"-link").hide(),x(),$("input,textarea",b).focus(),!1}function P(a,c){a=$(a);var b=a.get(0).id,d=a.children("fieldset");if(d.length){b||(b="rcmtabcontainer",a.attr("id",b));var f=$("<ul>").addClass("tabsbar").prependTo(a);d.each(function(l){var m=$(this),q=m.children("legend"),A=b+"-t"+l;var X=$("<a>").text(q.text()).attr("href","#"+A);l=$("<li>").addClass("tablink");q.remove();m.attr("id",A);l.append(X).appendTo(f)});a.tabs({active:c||0,heightStyle:"content",activate:function(l,m){w()}})}}
var C={},F={},z={forwardmenu:{editable:1},searchmenu:{editable:1,callback:function(a){if(a&&rcmail.env.search_mods){var c;a=$('input:checkbox[name="s_mods[]"]',F.searchmenu);var b=rcmail.env.mailbox,d=rcmail.env.search_mods,f=rcmail.env.search_scope||"base";if("mail"==rcmail.env.task){"all"==f&&(b="*");d=d[b]?d[b]:d["*"];var l="text";$('input:radio[name="s_scope"]').prop("checked",!1).filter("#s_scope_"+f).prop("checked",!0)}else l="*";if(d[l])a.map(function(){this.checked=!0;this.disabled=this.value!=
l});else for(c in a.prop("disabled",!1).prop("checked",!1),d)$("#s_mod_"+c).prop("checked",!0)}}},attachmentmenu:{},listoptions:{editable:1},groupmenu:{above:1},mailboxmenu:{above:1},spellmenu:{callback:function(a,c){var b,d=rcmail.spellcheck_lang(),f=$("ul",c.obj);if(!f.length){f=$('<ul class="toolbarmenu selectable" role="menu">');for(b in rcmail.env.spell_langs){var l=$('<li role="menuitem">');a=$('<a href="#'+b+'" tabindex="0"></a>').text(rcmail.env.spell_langs[b]).addClass("active").data("lang",
b).on("click keypress",function(m){if("keypress"!=m.type||13==rcube_event.get_keycode(m))return rcmail.spellcheck_lang_set($(this).data("lang")),rcmail.hide_menu("spellmenu",m),!1});a.appendTo(l);l.appendTo(f)}f.appendTo(c.obj)}$("li",f).each(function(){var m=$("a",this);m.data("lang")==d?m.addClass("selected").attr("aria-selected","true"):m.hasClass("selected")&&m.removeClass("selected").removeAttr("aria-selected")})}},"folder-selector":{iconized:1}},r=this,E,D,M={},u;this.set=function(a,c){C[a]=
c};this.init=function(){rcmail.addEventListener("message",p);$.widget("ui.dialog",$.ui.dialog,{open:function(){this._super();var b=$(this.uiDialog),d=b.offset(),f=b.position(),l=b.outerWidth(),m=$(window).width(),q=d.top-12;0>q&&b.css("top",f.top-q);d.left+l+12>m&&b.css("left",f.left-12);return this}});$("#taskbar a").each(function(b,d){$(d).append('<span class="tooltip">'+$(".button-inner",this).html()+"</span>")});$("#taskbar .minmodetoggle").click(function(b){b=$(document.body).toggleClass("minimal").hasClass("minimal");
v("minimalmode",b?1:0);$(window).resize()});if("mail"==rcmail.env.task){rcmail.addEventListener("menu-open",H).addEventListener("menu-close",H).addEventListener("menu-save",U).addEventListener("enable-command",R).addEventListener("responseafterlist",function(b){G(rcmail.env.threading?"thread":"list",!0)}).addEventListener("responseaftersearch",function(b){G(rcmail.env.threading?"thread":"list",!0)});var a=$("#dragmessagemenu");a.length&&(rcmail.gui_object("dragmenu","dragmessagemenu"),F.dragmenu=
a);"show"==rcmail.env.action||"preview"==rcmail.env.action?(rcmail.addEventListener("aftershow-headers",function(){e()}).addEventListener("afterhide-headers",function(){e()}),$("#previewheaderstoggle").click(function(b){O();this.blur&&!rcube_event.is_keyboard(b)&&this.blur();return!1}),$("#attachment-list > li").each(function(){L(this)}),"1"==k("previewheaders")&&O(),"show"==rcmail.env.action&&$("#messagecontent").focus()):"compose"==rcmail.env.action?(rcmail.addEventListener("fileappended",function(b){b.attachment.complete&&
L(b.item)}).addEventListener("aftertoggle-editor",function(b){window.setTimeout(function(){x()},200)}).addEventListener("compose-encrypted",function(b){$("select[name='editorSelector']").prop("disabled",b.active);$("a.button.attach, a.button.responses")[b.active?"addClass":"removeClass"]("disabled");$("#responseslist a.insertresponse")[b.active?"removeClass":"addClass"]("active")}),t(),$("#composeoptionstoggle").click(function(b){var d=$("#composeoptions").toggle().is(":visible");$("#composeoptionstoggle").toggleClass("remove").attr("aria-expanded",
d?"true":"false");x();v("composeoptions",d?"1":"0");rcube_event.is_keyboard(b)||this.blur();return!1}).css("cursor","pointer"),"0"!==k("composeoptions")&&$("#composeoptionstoggle").click(),(a=rcmail.opener())&&"compose"==a.env.action&&$("#composeoptionstoggle",opener.document).hasClass("remove")&&$("#composeoptionstoggle").click(),(new rcube_splitter({id:"composesplitterv",p1:"#composeview-left",p2:"#composeview-right",orientation:"v",relative:!0,start:206,min:170,size:12,render:x})).init(),$("#attachment-list > li").each(function(){L(this)})):
"bounce"==rcmail.env.action?t():"list"!=rcmail.env.action&&rcmail.env.action?"get"==rcmail.env.action&&(new rcube_splitter({id:"mailpartsplitterv",p1:"#messagepartheader",p2:"#messagepartcontainer",orientation:"v",relative:!0,start:226,min:150,size:12})).init():(y(),$("#maillistmode").addClass(rcmail.env.threading?"":"selected").click(function(b){G("list");return!1}),$("#mailthreadmode").addClass(rcmail.env.threading?"selected":"").click(function(b){G("thread");return!1}),rcmail.init_pagejumper("#pagejumper"),
rcmail.addEventListener("setquota",J).addEventListener("layout-change",y));$("#mailview-left").length&&(new rcube_splitter({id:"mailviewsplitterv",p1:"#mailview-left",p2:"#mailview-right",orientation:"v",relative:!0,start:206,min:150,size:12,callback:g,render:n})).init()}else if("settings"==rcmail.env.task)if(rcmail.addEventListener("init",function(){var b="#settingstabpreferences";rcmail.env.action&&(b="#settingstab"+(0<rcmail.env.action.indexOf("identity")?"identities":rcmail.env.action.replace(/\./g,
"")));$(b).addClass("selected").children().first().removeAttr("onclick").click(function(){return!1})}),"folders"==rcmail.env.action)(new rcube_splitter({id:"folderviewsplitter",p1:"#folderslist",p2:"#folder-details",orientation:"v",relative:!0,start:266,min:180,size:12})).init(),rcmail.addEventListener("setquota",J),N($("#folderslist"));else if("identities"==rcmail.env.action)(new rcube_splitter({id:"identviewsplitter",p1:"#identitieslist",p2:"#identity-details",orientation:"v",relative:!0,start:266,
min:180,size:12})).init();else if("responses"==rcmail.env.action)(new rcube_splitter({id:"responseviewsplitter",p1:"#responseslist",p2:"#response-details",orientation:"v",relative:!0,start:266,min:180,size:12})).init();else if("preferences"==rcmail.env.action||!rcmail.env.action)(new rcube_splitter({id:"prefviewsplitter",p1:"#sectionslist",p2:"#preferences-box",orientation:"v",relative:!0,start:266,min:180,size:12})).init();else{if("edit-prefs"==rcmail.env.action){a=$("#preferences-details fieldset.advanced legend");
var c=$('<a href="#toggle"></a>').text(rcmail.gettext("toggleadvancedoptions")).attr("title",rcmail.gettext("toggleadvancedoptions")).addClass("advanced-toggle");a.click(function(b){c.html($(this).hasClass("collapsed")?"&#9650;":"&#9660;");$(this).toggleClass("collapsed").closest("fieldset").children(".propform").toggle()}).append(c).addClass("collapsed");bw.mz&&a.parents("form").css("display","inline")}}else"addressbook"==rcmail.env.task&&(rcmail.addEventListener("beforepushgroup",V).addEventListener("beforepopgroup",
W).addEventListener("menu-open",H).addEventListener("menu-close",H),""==rcmail.env.action&&((new rcube_splitter({id:"addressviewsplitterd",p1:"#addressview-left",p2:"#addressview-right",orientation:"v",relative:!0,start:206,min:150,size:12,render:n})).init(),(new rcube_splitter({id:"addressviewsplitter",p1:"#addresslist",p2:"#contacts-box",orientation:"v",relative:!0,start:266,min:260,size:12})).init()),a=$("#dragcontactmenu"),a.length&&(rcmail.gui_object("dragmenu","dragcontactmenu"),F.dragmenu=
a));$(".tabbed").each(function(b,d){P(d)});$("select.decorated").each(function(){if(bw.opera)$(this).removeClass("decorated");else{var b=$(this),d=b.parent(),f=Math.max(b.height(),26)-2,l=b.width()-22,m=$("option",this).first().text();""!=$("option:selected",this).val()&&(m=$("option:selected",this).text());var q=$('<a class="menuselector" tabindex="-1"><span class="handle">'+m+"</span></a>").css("position","absolute").offset(b.position()).insertAfter(b);q.children().width(l).height(f).css("line-height",
f-1+"px");"absolute"!=d.css("position")&&d.css("position","relative");b.width(q.width()).on(bw.mz?"change keyup":"change",function(){var A=$("option:selected",this).text();$(this).next().children().text(A)});b.on("focus",function(A){q.addClass("focus")}).on("blur",function(A){q.removeClass("focus")})}});a=$("body.minwidth");a.length&&a.css("min-width",$(".toolbar").width()+$("#quicksearchbar").width()+$("#searchfilter").width()+30);window.onresize=w;w()};this.init_tabs=P;this.show_about=function(a){var c=
$("<iframe>").attr({id:"aboutframe",src:rcmail.url("settings/about"),frameborder:"0"});h=Math.floor(.75*$(window).height());buttons={};supportln=$("#supportlink");supportln.length&&(C.supporturl=supportln.attr("href"))&&(buttons[supportln.html()]=function(b){0>C.supporturl.indexOf("mailto:")?window.open(C.supporturl):location.href=C.supporturl});c.dialog({modal:!0,resizable:!1,closeOnEscape:!0,title:a?a.title||a.innerHTML:null,close:function(){c.dialog("destroy").remove()},buttons:buttons,width:640,
height:h}).width(640)};this.show_popup=function(a,c,b){!b&&z[a]||K(a,b);b=z[a]||{};b=$(b.link?b.link:"#"+a+"link");var d=b.offset();b.has(".inner")&&(b=b.children(".inner"));return rcmail.command("menu-open",{menu:a,show:c},b.get(0),$.Event("click",{target:b.get(0),pageX:d.left,pageY:d.top,clientX:d.left,clientY:d.top}))};this.toggle_popup=function(a,c,b){!b&&z[a]||K(a,b);return rcmail.command("menu-open",a,c.target,c)};this.add_popup=K;this.import_dialog=function(){var a=$("#uploadform").clone().removeClass("popupdialog");
rcmail.simple_dialog(a,rcmail.gettext("importmessages"),function(c){return rcmail.command("import-messages",$(a.find("form")[0]))},{button:"import",closeOnEscape:!0,minWidth:400})};this.set_searchmod=function(a){var c=rcmail.env.task;var b=rcmail.env.search_mods,d=rcmail.env.mailbox;"all"==$('input[name="s_scope"]:checked').val()&&(d="*");b||(b={});if("mail"==c){b[d]||(b[d]=rcube_clone_object(b["*"]));var f=b[d];c="text"}else f=b,c="*";a.checked?f[a.value]=1:delete f[a.value];a.value==c&&$('input:checkbox[name="s_mods[]"]').map(function(){this!=
a&&(this.checked=!0,a.checked?(this.disabled=!0,delete f[this.value]):(this.disabled=!1,f[this.value]=1))});rcmail.set_searchmods(f)};this.set_searchscope=function(a){rcmail.set_searchscope(a.value)};this.show_header_row=I;this.hide_header_row=function(a){var c=$("#_"+a);M[a]=c.val();c.val("");$("#compose-"+a).hide();$("#"+a+"-link").show();x();return!1};this.update_quota=J;this.get_pref=k;this.save_pref=v;this.folder_search_init=N;if(window.$&&document.body){var Q=k("minimalmode");(parseInt(Q)||
null===Q&&850>$(window).height())&&$(document.body).addClass("minimal");bw.tablet&&$("#viewport").attr("content","width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0");$(document).ready(function(){r.init()})}}
function rcube_scroller(k,v,w){var p=this;this.list=$(k);this.top=$(v);this.bottom=$(w);this.step_size=6;this.step_time=20;this.delay=500;this.top.mouseenter(function(){rcmail.drag_active&&(p.ts=window.setTimeout(function(){p.scroll("down")},p.delay))}).mouseout(function(){p.ts&&window.clearTimeout(p.ts)});this.bottom.mouseenter(function(){rcmail.drag_active&&(p.ts=window.setTimeout(function(){p.scroll("up")},p.delay))}).mouseout(function(){p.ts&&window.clearTimeout(p.ts)});this.scroll=function(y){var e=
this,g=this.step_size;rcmail.drag_active&&("down"==y&&(g*=-1),this.list.get(0).scrollTop+=g,this.ts=window.setTimeout(function(){e.scroll(y)},this.step_time))}}
function rcube_splitter(k){function v(g){if(bw.konq||bw.chrome||bw.safari)document.body.style.webkitUserSelect="none";e.p1pos=e.relative?e.p1.position():e.p1.offset();e.p2pos=e.relative?e.p2.position():e.p2.offset();e.drag_active=!0;$(document).on("mousemove."+this.id,w).on("mouseup."+this.id,p);rcmail.message_list&&(rcmail.message_list.drag_active=!0);$("iframe").each(function(n,t){$("<div>").attr("id","iframe-splitter-fix-"+n).addClass("iframe-splitter-fix").css({background:"#fff",width:t.offsetWidth+
"px",height:t.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1E3}).css($(this).offset()).appendTo("body")})}function w(g){if(!e.drag_active)return!1;window.clearTimeout(e.ts);e.ts=window.setTimeout(function(){var n=rcube_event.get_mouse_pos(g);if(e.relative){var t=e.parent.offset();n.x-=t.left;n.y-=t.top}e.horizontal?n.y-e.halfsize>e.p1pos.top&&n.y+e.halfsize<e.p2pos.top+e.p2.outerHeight()&&(e.pos=Math.max(e.min,n.y-Math.max(0,e.offset)),e.pos>e.min&&(e.pos=Math.min(e.pos,e.parent.height()-
e.min)),e.resize()):n.x-e.halfsize>e.p1pos.left&&n.x+e.halfsize<e.p2pos.left+e.p2.outerWidth()&&(e.pos=Math.max(e.min,n.x-Math.max(0,e.offset)),e.pos>e.min&&(e.pos=Math.min(e.pos,e.parent.width()-e.min)),e.resize());e.p1pos=e.relative?e.p1.position():e.p1.offset();e.p2pos=e.relative?e.p2.position():e.p2.offset()},1);return!1}function p(g){if(bw.konq||bw.chrome||bw.safari)document.body.style.webkitUserSelect="auto";$(document).off("."+e.id);e.drag_active=!1;rcmail.message_list&&(rcmail.message_list.drag_active=
!1);$("div.iframe-splitter-fix").remove();e.set_cookie();"function"==typeof e.callback&&e.callback(e);return bw.safari?!0:rcube_event.cancel(g)}function y(g){e.horizontal?(g=parseInt(e.parent.outerHeight(),10)-parseInt(e.p2[0].style.top,10),e.p2.css("height",(0<g?g:0)+"px")):(g=parseInt(e.parent.outerWidth(),10)-parseInt(e.p2[0].style.left,10),e.p2.css("width",(0<g?g:0)+"px"))}this.p=k;this.id=k.id;this.horizontal="horizontal"==k.orientation||"h"==k.orientation;this.halfsize=(void 0!==k.size?k.size:
10)/2;this.pos=k.start||0;this.min=k.min||20;this.offset=k.offset||0;this.relative=k.relative?!0:!1;this.drag_active=!1;this.render=k.render;this.callback=k.callback;var e=this;rcube_splitter._instances[this.id]=e;this.init=function(){this.p1=$(this.p.p1);this.p2=$(this.p.p2);this.parent=this.p1.parent();if(this.p1.length&&this.p2.length){this.p1pos=this.relative?this.p1.position():this.p1.offset();this.p2pos=this.relative?this.p2.position():this.p2.offset();this.handle=$("<div>").attr("id",this.id).attr("unselectable",
"on").attr("role","presentation").addClass("splitter "+(this.horizontal?"splitter-h":"splitter-v")).appendTo(this.parent).mousedown(v);if(this.horizontal){var g=this.p1pos.top+this.p1.outerHeight();this.handle.css({left:"0px",top:g+"px"})}else g=this.p1pos.left+this.p1.outerWidth(),this.handle.css({left:g+"px",top:"0px"});bw.ie&&$(window).resize(y);(g=this.get_cookie())&&!isNaN(g)?(this.pos=parseFloat(g),this.resize()):this.pos&&(this.resize(),this.set_cookie())}};this.resize=function(){if(this.horizontal){if(this.p1.css("height",
Math.floor(this.pos-this.p1pos.top-Math.floor(this.halfsize))+"px"),this.p2.css("top",Math.ceil(this.pos+Math.ceil(this.halfsize)+2)+"px"),this.handle.css("top",Math.round(this.pos-this.halfsize+this.offset)+"px"),bw.ie){var g=parseInt(this.parent.outerHeight(),10)-parseInt(this.p2.css("top"),10);this.p2.css("height",(0<g?g:0)+"px")}}else this.p1.css("width",Math.floor(this.pos-this.p1pos.left-Math.floor(this.halfsize))+"px"),this.p2.css("left",Math.ceil(this.pos+Math.ceil(this.halfsize))+"px"),this.handle.css("left",
Math.round(this.pos-this.halfsize+this.offset+3)+"px"),bw.ie&&(g=parseInt(this.parent.outerWidth(),10)-parseInt(this.p2.css("left"),10),this.p2.css("width",(0<g?g:0)+"px"));this.p2.resize();this.p1.resize();this.drag_active&&$("iframe").each(function(n,t){var B=$(this).offset();$("#iframe-splitter-fix-"+n).css({top:B.top+"px",left:B.left+"px",width:t.offsetWidth+"px",height:t.offsetHeight+"px"})});"function"==typeof this.render&&this.render(this)};this.get_cookie=function(){return window.UI?UI.get_pref(this.id):
null};this.set_cookie=function(){window.UI&&UI.save_pref(this.id,this.pos)}}rcube_splitter._instances={};rcube_splitter.get_instance=function(k){return rcube_splitter._instances[k]};
